(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{516:function(s,n,a){"use strict";a.r(n);var e=a(2),t=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"redis安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#redis安装"}},[s._v("#")]),s._v(" redis安装")]),s._v(" "),n("p",[s._v("linux：https://redis.io/download")]),s._v(" "),n("p",[s._v("windows: https://github.com/MicrosoftArchive/redis/releases")]),s._v(" "),n("p",[s._v("远程工具：https://github.com/qishibo/AnotherRedisDesktopManager/releases")]),s._v(" "),n("blockquote",[n("p",[s._v("本文采用redis7.2.6版本搭建")])]),s._v(" "),n("h2",{attrs:{id:"主从复制"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#主从复制"}},[s._v("#")]),s._v(" 主从复制")]),s._v(" "),n("p",[s._v("主从复制将redis服务器隔离开，一个主节点（master）用于写入，多个从节点（slave）只可读")]),s._v(" "),n("p",[n("strong",[s._v("新增conf文件：6380、6381、6382")])]),s._v(" "),n("p",[s._v("复制以下文件内容，修改不为不同端口，不同日志文件")]),s._v(" "),n("blockquote",[n("p",[s._v("prot 6379")]),s._v(" "),n("p",[s._v("pidfile /var/run/redis_6380.pid")]),s._v(" "),n("p",[s._v("dbfilename dump6380.rdb")]),s._v(" "),n("p",[s._v('appendfilename "6380.aof"')])]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("################################## NETWORK #####################################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#绑定ip")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#bind 127.0.0.1 ::1")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#bind 0.0.0.0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#保护模式")]),s._v("\nprotected-mode no\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#端口设置6380")]),s._v("\nport "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6380")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#密码")]),s._v("\nrequirepass "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xcw1017!"')]),s._v("\n\ntcp-backlog "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("511")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 它可以决定一个空闲的客户端维持多少秒会关闭 0禁用")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("timeout")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对访问客户端的一种心跳检测，每个n秒检测一次。单位为秒，如果设置为0，则不会进行Keepalive检测")]),s._v("\ntcp-keepalive "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("################################# GENERAL #####################################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 以守护进程的方式运行，默认no")]),s._v("\ndaemonize "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果以后台的方式运行，我们就需要指定一个pid文件！")]),s._v("\npidfile /var/run/redis_6380.pid\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定服务器冗长级别.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# debug (大量的信息，对开发/测试很有用)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# verbose (许多很少有用的信息，但不像debug级别那样混乱)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# notice (稍微冗长一些，可能是您在生产环境中需要的)")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# warning (只记录非常重要/关键的消息)")]),s._v("\nloglevel notice\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定日志文件名")]),s._v("\nlogfile "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 数据库数量默认16个")]),s._v("\ndatabases "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否总显示logo")]),s._v("\nalways-show-logo no\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认情况下，Redis 会修改进程标题（如“top”和“ps”所示）以提供一些运行时信息。 可以通过将以下设置为 no 来禁用它并使进程名称保持为已执行状态。")]),s._v("\nset-proc-title "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  更改进程标题时，Redis 使用以下模板来构造修改后的标题")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# {title}           父进程执行的进程名称，或子进程的类型.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# {listen-addr}     绑定地址或 ‘*’ 后跟 TCP 或 TLS 端口侦听，或 Unix 套接字（如果可用）")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# {server-mode}     特殊模式，即“[sentinel]”或“[cluster]”")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# {port}            TCP 端口监听，或 0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# {tls-port}        TLS 端口监听，或 0")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# {unixsocket}      监听的 Unix 域套接字，或 “”.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# {config-file}     使用的配置文件的名称.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\nproc-title-template "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{title} {listen-addr} {server-mode}"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("################################ 快照  ################################")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 持久化，将数据库保存到磁盘。AOF和RDB持久化实例.")]),s._v("\nsave "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3600")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nsave "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("300")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\nsave "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# save <seconds> <changes> [<seconds> <changes> ...]")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以使用单个空字符串参数完全禁用快照")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# save ""')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   * 3600 秒（一小时）后，如果至少 1 个键发生了变化")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# save 3600 1")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   * 300 秒（5 分钟）后，如果至少有 100 个键被更改")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# save 300 100")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#   * 60 秒后，如果至少有 10000 个键被更改")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# save 60 10000")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 持久化出错如果出错，是否需要继续工作！")]),s._v("\nstop-writes-on-bgsave-error "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否压缩 rdb 文件，需要消耗一些 CPU 资源")]),s._v("\nrdbcompression "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存 rdb 文件，进行错误的检查检验！")]),s._v("\nrdbchecksum "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rdb文件名")]),s._v("\ndbfilename dump6380.rdb\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除非持久化实例中复制使用的RDB文件")]),s._v("\nrdb-del-sync-files no\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rdb 文件的保存目录")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v(" /opt/homebrew/etc/redis/db/  \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("################################# 主从复制 #################################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# replicaof <masterip> <masterport>")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果主节点设置了密码，则设置访问主节点的密码")]),s._v("\nmasterauth "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xcw1017!"')]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用于配置链接主服务器的用户，默认用户无法运行PSYNC，最好提供一个特殊的用户。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# masteruser <username>")]),s._v("\n\nreplica-serve-stale-data "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 主从时期，从库是否只读，默认yes（只读）。非只读可以存储一些临时数据（在主从同步时会覆盖存储的数据）")]),s._v("\nreplica-read-only "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 主从数据复制同步策划：文件或套接字，默认为套接字传输数据")]),s._v("\nrepl-diskless-sync "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当启用无硬盘备份，服务器等待一段时间后才会通过套接字向从节点传送RDB文件，这个等待时间是可配置的。 ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 一旦传输备份数据开始，主节点不会再接收新从节点的复制请求直到下一个rdb传输。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从节点节点徐要排队等待下一次RDB传送。因此服务器等待一段时间以期更多的从节点获取到连接。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 延迟时间以秒为单位，默认为5秒。要关掉这一功能，只需将它设置为0秒，传送会立即启动")]),s._v("\nrepl-diskless-sync-delay "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当启用无硬盘备份，服务器等待一段时间后内，如果达到预期的最大副本连接数则可以直接开始传送")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 0 ~ 无限大 （正整数）。 默认 0")]),s._v("\nrepl-diskless-sync-max-replicas "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# RDB文件落在Slave磁盘上模式， 直接从socket获取rdb数据，是需要拿到完整的rdb数据才开始进行同步")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# disable 不使用无硬盘方案  ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# on-empty-db 只有在完全安全才使用无硬盘      ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# swapdb 在解析socket的rdb数据时，将当前数据库的数据放到内存中，这样可以在复制的时候为客户端提供服务，但是可能会造成内存溢出")]),s._v("\nrepl-diskless-load disabled\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同步之后是否禁用从节点上的TCP_NODELAY。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yes，redis会使用较少量的TCP包和带宽向从节点发送数据。但这可能会增加从节点的数据的延迟，Linux 内核使用默认最长40毫秒 。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# no，从节点的数据延时不会那么多，但备份需要的带宽相对较多。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认情况下我们将潜在因素优化，但在高负载情况下或者在主从节点都跳的情况下，把它设置为yes更好。默认值为no。")]),s._v("\nrepl-disable-tcp-nodelay no\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从redis设置升级主节点的优先级，在主redis持续不正常工作的情况下，优先级高的redis会升级为主节点。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编号越小，优先级越高。当优先级设置为0，则永远不会被选中。默认的优先级为100。")]),s._v("\nreplica-priority "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("################################## SECURITY ###################################")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ACL日志大小。ACL日志跟踪与ACL关联的失败命令和身份验证事件。ACL 日志存储在内存中。 在下面定义 ACL 日志的最大条目长度")]),s._v("\nacllog-max-len "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("\n\n\n\nlazyfree-lazy-eviction no\nlazyfree-lazy-expire no\nlazyfree-lazy-server-del no\nreplica-lazy-flush no\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# It is also possible, for the case when to replace the user code DEL calls")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# with UNLINK calls is not easy, to modify the default behavior of the DEL")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# command to act exactly like UNLINK, using the following configuration")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# directive:")]),s._v("\n\nlazyfree-lazy-user-del no\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# FLUSHDB, FLUSHALL, SCRIPT FLUSH and FUNCTION FLUSH support both asynchronous and synchronous")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# deletion, which can be controlled by passing the [SYNC|ASYNC] flags into the")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# commands. When neither flag is passed, this directive will be used to determine")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# if the data should be deleted asynchronously.")]),s._v("\n\nlazyfree-lazy-user-flush no\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 内存不足时杀死哪些进程")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# no: 在所有其他进程之前先杀死后台子进程，并且在主进程之前杀死其他进程 《默认》。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yes: 相对的。是 relative 选择的别名。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# absolute: 超过 oom-score-adj-values 值时内存泄漏。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# relative: 服务器启动，将值改为 -1000 ~ 1000 的范围内。")]),s._v("\noom-score-adj no\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# oom-score-adj设置absolute生效，此指令控制用于主进程、副本进程和后台子进程的特定值。数值范围为-2000到2000（越高意味着越有可能被杀死）")]),s._v("\noom-score-adj-values "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("200")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("800")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#################### KERNEL transparent hugepage CONTROL ######################")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 帮助用户检查和解决可能的数据查询延迟的数据。")]),s._v("\ndisable-thp "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("############################## APPEND ONLY MODE  AOF持久化###############################")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否开启AOF持久化")]),s._v("\nappendonly "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文件名称")]),s._v("\nappendfilename "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6380.aof"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#aof文件目录")]),s._v("\nappenddirname "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"appendonlydir"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 持久化同步策略   ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# everysec：每秒执行，发送异常时可能会丢失最后一秒的数据。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# always：每次写操作执行，数据最安全，但是对性能有影响。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# no：不强制刷盘，不主动同步数据，由内核决定什么时候刷盘，数据最不安全，性能最好。")]),s._v("\nappendfsync everysec\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在重写时是否持久化aof文件。在aof重写或者写入rdb文件的时候，会执行大量IO，此时对于everysec和always的aof模式来说，")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行fsync会造成阻塞过长时间，所以设置no-appendfsync-on-rewrite为no。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果对延迟要求很高的应用，这个字段可以设置为yes，否则设置为no，这样对持久化特性来说是更安全的选择。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置为yes表示rewrite期间对新写操作不fsync,暂时存在内存中,等rewrite完成后再写入aof文件。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Linux的默认fsync策略是30秒。默认值为no，可能丢失30秒内数据")]),s._v("\nno-appendfsync-on-rewrite no\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自动重写AOF文件 ")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在AOF文件大小增长到了指定的百分比（相对于上次AOF文件大小的增长量）或者指定的最小体积时，会自动调用BGREWRITEAOF命令重写AOF文件。")]),s._v("\nauto-aof-rewrite-percentage "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\nauto-aof-rewrite-min-size 64mb\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# AOF文件末尾截断时的处理策略。在服务意外中断是会导致aof文件的内存被截断（不完整），重启服务时时候加载aof文件。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yes，即使文件发生了截断也要加载文件。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# no：如果AOF文件发生了截断，启动服务时会拒绝启动。")]),s._v("\naof-load-truncated "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启混合持久化（使用aof持久化同时使用rdb存储数据)")]),s._v("\naof-use-rdb-preamble "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Redis支持AOF中记录时间戳，支持特定时间点的恢复数据，但是可能会与现有的AOF解析器不兼容的方式更改AOF格式")]),s._v("\naof-timestamp-enabled no\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("################################## SLOW LOG ###################################")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 慢日志记录阈值。命令执行时间超过这个值就会被记录到慢日志中，默认值是10000微秒。下面的时间用微秒表示，所以1000000相当于一秒")]),s._v("\nslowlog-log-slower-than "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 慢日志文件大小。慢日志文件超过这个长度后最旧的记录会被删除，默认值是128条")]),s._v("\nslowlog-max-len "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("################################ LATENCY MONITOR ##############################")]),s._v("\nlatency-monitor-threshold "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("############################# EVENT NOTIFICATION  事件通知管理##############################")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Redis 可以通知 Pub/Sub 客户端有关key缓存数据中发生的事件")]),s._v("\nnotify-keyspace-events "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("############################### ADVANCED CONFIG ###############################")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 哈希在条目数量较少且最大条目不超过给定阈值时，哈希使用内存高效数据结构进行编码")]),s._v("\nhash-max-listpack-entries "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("\nhash-max-listpack-value "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 性能最高的选项通常是 -2（8 Kb 大小）或 -1（4 Kb 大小）")]),s._v("\nlist-max-listpack-size "),n("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-2")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  ")]),s._v("\nlist-compress-depth "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当集合（Set）仅由恰好是基数为10的64位有符号整数范围内的整数的字符串组成时，集合使用特殊编码")]),s._v("\nset-max-intset-entries "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("512")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 散列hash和列表list类似，排序集也经过特殊编码，以节省大量空间。此编码仅在排序集的长度和元素低于以下限制时使用")]),s._v("\nzset-max-listpack-entries "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v("\nzset-max-listpack-value "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("64")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# HyperLogLog sparse representation bytes limit. The limit includes the")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 16 bytes header. When an HyperLogLog using the sparse representation crosses")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# this limit, it is converted into the dense representation.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# A value greater than 16000 is totally useless, since at that point the")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# dense representation is more memory efficient.")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The suggested value is ~ 3000 in order to have the benefits of")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# the space efficient encoding without slowing down too much PFADD,")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# which is O(N) with the sparse encoding. The value can be raised to")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ~ 10000 when CPU is not a concern, but space is, and the data set is")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# composed of many HyperLogLogs with cardinality in the 0 - 15000 range.")]),s._v("\nhll-sparse-max-bytes "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 单位为 Byte，默认值 4096，用于设定每个宏节点占用的内存上限为 4096，0 表示无限制。")]),s._v("\nstream-node-max-bytes "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设定每个宏节点存储元素个数。")]),s._v("\nstream-node-max-entries "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\nactiverehashing "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\nclient-output-buffer-limit normal "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nclient-output-buffer-limit replica 256mb 64mb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\nclient-output-buffer-limit pubsub 32mb 8mb "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# .")]),s._v("\nhz "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# .")]),s._v("\ndynamic-hz "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当重写AOF文件时，如果启用以下选项，则每生成4 MB的数据，就会对文件进行fsync。这对于更增量地将文件提交到磁盘并避免大的延迟峰值非常有用.")]),s._v("\naof-rewrite-incremental-fsync "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当redis保存RDB文件时，如果启用以下选项，则每生成4MB的数据就会对该文件进行fsync。这对于更增量地将文件提交到磁盘并避免大的延迟峰值非常有用")]),s._v("\nrdb-save-incremental-fsync "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br"),n("span",{staticClass:"line-number"},[s._v("138")]),n("br"),n("span",{staticClass:"line-number"},[s._v("139")]),n("br"),n("span",{staticClass:"line-number"},[s._v("140")]),n("br"),n("span",{staticClass:"line-number"},[s._v("141")]),n("br"),n("span",{staticClass:"line-number"},[s._v("142")]),n("br"),n("span",{staticClass:"line-number"},[s._v("143")]),n("br"),n("span",{staticClass:"line-number"},[s._v("144")]),n("br"),n("span",{staticClass:"line-number"},[s._v("145")]),n("br"),n("span",{staticClass:"line-number"},[s._v("146")]),n("br"),n("span",{staticClass:"line-number"},[s._v("147")]),n("br"),n("span",{staticClass:"line-number"},[s._v("148")]),n("br"),n("span",{staticClass:"line-number"},[s._v("149")]),n("br"),n("span",{staticClass:"line-number"},[s._v("150")]),n("br"),n("span",{staticClass:"line-number"},[s._v("151")]),n("br"),n("span",{staticClass:"line-number"},[s._v("152")]),n("br"),n("span",{staticClass:"line-number"},[s._v("153")]),n("br"),n("span",{staticClass:"line-number"},[s._v("154")]),n("br"),n("span",{staticClass:"line-number"},[s._v("155")]),n("br"),n("span",{staticClass:"line-number"},[s._v("156")]),n("br"),n("span",{staticClass:"line-number"},[s._v("157")]),n("br"),n("span",{staticClass:"line-number"},[s._v("158")]),n("br"),n("span",{staticClass:"line-number"},[s._v("159")]),n("br"),n("span",{staticClass:"line-number"},[s._v("160")]),n("br"),n("span",{staticClass:"line-number"},[s._v("161")]),n("br"),n("span",{staticClass:"line-number"},[s._v("162")]),n("br"),n("span",{staticClass:"line-number"},[s._v("163")]),n("br"),n("span",{staticClass:"line-number"},[s._v("164")]),n("br"),n("span",{staticClass:"line-number"},[s._v("165")]),n("br"),n("span",{staticClass:"line-number"},[s._v("166")]),n("br"),n("span",{staticClass:"line-number"},[s._v("167")]),n("br"),n("span",{staticClass:"line-number"},[s._v("168")]),n("br"),n("span",{staticClass:"line-number"},[s._v("169")]),n("br"),n("span",{staticClass:"line-number"},[s._v("170")]),n("br"),n("span",{staticClass:"line-number"},[s._v("171")]),n("br"),n("span",{staticClass:"line-number"},[s._v("172")]),n("br"),n("span",{staticClass:"line-number"},[s._v("173")]),n("br"),n("span",{staticClass:"line-number"},[s._v("174")]),n("br"),n("span",{staticClass:"line-number"},[s._v("175")]),n("br"),n("span",{staticClass:"line-number"},[s._v("176")]),n("br"),n("span",{staticClass:"line-number"},[s._v("177")]),n("br"),n("span",{staticClass:"line-number"},[s._v("178")]),n("br"),n("span",{staticClass:"line-number"},[s._v("179")]),n("br"),n("span",{staticClass:"line-number"},[s._v("180")]),n("br"),n("span",{staticClass:"line-number"},[s._v("181")]),n("br"),n("span",{staticClass:"line-number"},[s._v("182")]),n("br"),n("span",{staticClass:"line-number"},[s._v("183")]),n("br"),n("span",{staticClass:"line-number"},[s._v("184")]),n("br"),n("span",{staticClass:"line-number"},[s._v("185")]),n("br"),n("span",{staticClass:"line-number"},[s._v("186")]),n("br"),n("span",{staticClass:"line-number"},[s._v("187")]),n("br"),n("span",{staticClass:"line-number"},[s._v("188")]),n("br"),n("span",{staticClass:"line-number"},[s._v("189")]),n("br"),n("span",{staticClass:"line-number"},[s._v("190")]),n("br"),n("span",{staticClass:"line-number"},[s._v("191")]),n("br"),n("span",{staticClass:"line-number"},[s._v("192")]),n("br"),n("span",{staticClass:"line-number"},[s._v("193")]),n("br"),n("span",{staticClass:"line-number"},[s._v("194")]),n("br"),n("span",{staticClass:"line-number"},[s._v("195")]),n("br"),n("span",{staticClass:"line-number"},[s._v("196")]),n("br"),n("span",{staticClass:"line-number"},[s._v("197")]),n("br"),n("span",{staticClass:"line-number"},[s._v("198")]),n("br"),n("span",{staticClass:"line-number"},[s._v("199")]),n("br"),n("span",{staticClass:"line-number"},[s._v("200")]),n("br"),n("span",{staticClass:"line-number"},[s._v("201")]),n("br"),n("span",{staticClass:"line-number"},[s._v("202")]),n("br"),n("span",{staticClass:"line-number"},[s._v("203")]),n("br"),n("span",{staticClass:"line-number"},[s._v("204")]),n("br"),n("span",{staticClass:"line-number"},[s._v("205")]),n("br"),n("span",{staticClass:"line-number"},[s._v("206")]),n("br"),n("span",{staticClass:"line-number"},[s._v("207")]),n("br"),n("span",{staticClass:"line-number"},[s._v("208")]),n("br"),n("span",{staticClass:"line-number"},[s._v("209")]),n("br"),n("span",{staticClass:"line-number"},[s._v("210")]),n("br"),n("span",{staticClass:"line-number"},[s._v("211")]),n("br"),n("span",{staticClass:"line-number"},[s._v("212")]),n("br"),n("span",{staticClass:"line-number"},[s._v("213")]),n("br"),n("span",{staticClass:"line-number"},[s._v("214")]),n("br"),n("span",{staticClass:"line-number"},[s._v("215")]),n("br"),n("span",{staticClass:"line-number"},[s._v("216")]),n("br"),n("span",{staticClass:"line-number"},[s._v("217")]),n("br"),n("span",{staticClass:"line-number"},[s._v("218")]),n("br"),n("span",{staticClass:"line-number"},[s._v("219")]),n("br"),n("span",{staticClass:"line-number"},[s._v("220")]),n("br"),n("span",{staticClass:"line-number"},[s._v("221")]),n("br"),n("span",{staticClass:"line-number"},[s._v("222")]),n("br"),n("span",{staticClass:"line-number"},[s._v("223")]),n("br"),n("span",{staticClass:"line-number"},[s._v("224")]),n("br"),n("span",{staticClass:"line-number"},[s._v("225")]),n("br"),n("span",{staticClass:"line-number"},[s._v("226")]),n("br"),n("span",{staticClass:"line-number"},[s._v("227")]),n("br"),n("span",{staticClass:"line-number"},[s._v("228")]),n("br"),n("span",{staticClass:"line-number"},[s._v("229")]),n("br"),n("span",{staticClass:"line-number"},[s._v("230")]),n("br"),n("span",{staticClass:"line-number"},[s._v("231")]),n("br"),n("span",{staticClass:"line-number"},[s._v("232")]),n("br"),n("span",{staticClass:"line-number"},[s._v("233")]),n("br"),n("span",{staticClass:"line-number"},[s._v("234")]),n("br"),n("span",{staticClass:"line-number"},[s._v("235")]),n("br"),n("span",{staticClass:"line-number"},[s._v("236")]),n("br"),n("span",{staticClass:"line-number"},[s._v("237")]),n("br"),n("span",{staticClass:"line-number"},[s._v("238")]),n("br"),n("span",{staticClass:"line-number"},[s._v("239")]),n("br"),n("span",{staticClass:"line-number"},[s._v("240")]),n("br"),n("span",{staticClass:"line-number"},[s._v("241")]),n("br"),n("span",{staticClass:"line-number"},[s._v("242")]),n("br"),n("span",{staticClass:"line-number"},[s._v("243")]),n("br"),n("span",{staticClass:"line-number"},[s._v("244")]),n("br"),n("span",{staticClass:"line-number"},[s._v("245")]),n("br"),n("span",{staticClass:"line-number"},[s._v("246")]),n("br"),n("span",{staticClass:"line-number"},[s._v("247")]),n("br"),n("span",{staticClass:"line-number"},[s._v("248")]),n("br"),n("span",{staticClass:"line-number"},[s._v("249")]),n("br"),n("span",{staticClass:"line-number"},[s._v("250")]),n("br"),n("span",{staticClass:"line-number"},[s._v("251")]),n("br"),n("span",{staticClass:"line-number"},[s._v("252")]),n("br"),n("span",{staticClass:"line-number"},[s._v("253")]),n("br"),n("span",{staticClass:"line-number"},[s._v("254")]),n("br"),n("span",{staticClass:"line-number"},[s._v("255")]),n("br"),n("span",{staticClass:"line-number"},[s._v("256")]),n("br"),n("span",{staticClass:"line-number"},[s._v("257")]),n("br"),n("span",{staticClass:"line-number"},[s._v("258")]),n("br"),n("span",{staticClass:"line-number"},[s._v("259")]),n("br"),n("span",{staticClass:"line-number"},[s._v("260")]),n("br"),n("span",{staticClass:"line-number"},[s._v("261")]),n("br"),n("span",{staticClass:"line-number"},[s._v("262")]),n("br"),n("span",{staticClass:"line-number"},[s._v("263")]),n("br"),n("span",{staticClass:"line-number"},[s._v("264")]),n("br"),n("span",{staticClass:"line-number"},[s._v("265")]),n("br"),n("span",{staticClass:"line-number"},[s._v("266")]),n("br"),n("span",{staticClass:"line-number"},[s._v("267")]),n("br"),n("span",{staticClass:"line-number"},[s._v("268")]),n("br"),n("span",{staticClass:"line-number"},[s._v("269")]),n("br"),n("span",{staticClass:"line-number"},[s._v("270")]),n("br"),n("span",{staticClass:"line-number"},[s._v("271")]),n("br"),n("span",{staticClass:"line-number"},[s._v("272")]),n("br"),n("span",{staticClass:"line-number"},[s._v("273")]),n("br"),n("span",{staticClass:"line-number"},[s._v("274")]),n("br"),n("span",{staticClass:"line-number"},[s._v("275")]),n("br"),n("span",{staticClass:"line-number"},[s._v("276")]),n("br"),n("span",{staticClass:"line-number"},[s._v("277")]),n("br"),n("span",{staticClass:"line-number"},[s._v("278")]),n("br"),n("span",{staticClass:"line-number"},[s._v("279")]),n("br"),n("span",{staticClass:"line-number"},[s._v("280")]),n("br"),n("span",{staticClass:"line-number"},[s._v("281")]),n("br"),n("span",{staticClass:"line-number"},[s._v("282")]),n("br"),n("span",{staticClass:"line-number"},[s._v("283")]),n("br"),n("span",{staticClass:"line-number"},[s._v("284")]),n("br"),n("span",{staticClass:"line-number"},[s._v("285")]),n("br"),n("span",{staticClass:"line-number"},[s._v("286")]),n("br"),n("span",{staticClass:"line-number"},[s._v("287")]),n("br"),n("span",{staticClass:"line-number"},[s._v("288")]),n("br"),n("span",{staticClass:"line-number"},[s._v("289")]),n("br"),n("span",{staticClass:"line-number"},[s._v("290")]),n("br"),n("span",{staticClass:"line-number"},[s._v("291")]),n("br"),n("span",{staticClass:"line-number"},[s._v("292")]),n("br"),n("span",{staticClass:"line-number"},[s._v("293")]),n("br"),n("span",{staticClass:"line-number"},[s._v("294")]),n("br"),n("span",{staticClass:"line-number"},[s._v("295")]),n("br"),n("span",{staticClass:"line-number"},[s._v("296")]),n("br"),n("span",{staticClass:"line-number"},[s._v("297")]),n("br"),n("span",{staticClass:"line-number"},[s._v("298")]),n("br"),n("span",{staticClass:"line-number"},[s._v("299")]),n("br"),n("span",{staticClass:"line-number"},[s._v("300")]),n("br"),n("span",{staticClass:"line-number"},[s._v("301")]),n("br"),n("span",{staticClass:"line-number"},[s._v("302")]),n("br")])]),n("h3",{attrs:{id:"启动redis服务"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#启动redis服务"}},[s._v("#")]),s._v(" 启动Redis服务")]),s._v(" "),n("p",[s._v("进入bin目录使用 "),n("code",[s._v("redis-server")]),s._v("启动")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[s._v("./redis-server /opt/homebrew/etc/redis/redis-sentinel/redis_6380.conf\n./redis-server /opt/homebrew/etc/redis/redis-sentinel/redis_6381.conf\n./redis-server /opt/homebrew/etc/redis/redis-sentinel/redis_6382.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("h3",{attrs:{id:"查看redis信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看redis信息"}},[s._v("#")]),s._v(" 查看Redis信息")]),s._v(" "),n("p",[s._v("新版本使用 info replication查看主从信息")]),s._v(" "),n("p",[n("strong",[s._v("查看节点信息")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://raw.githubusercontent.com/prank-xcw/images/master/imgs/202412031152736.png",alt:"image-20241203115233319"}})]),s._v(" "),n("p",[n("img",{attrs:{src:"https://raw.githubusercontent.com/prank-xcw/images/master/imgs/202412031145191.png",alt:"image-20241203104930121"}})]),s._v(" "),n("h2",{attrs:{id:"sentinel哨兵模式搭建"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sentinel哨兵模式搭建"}},[s._v("#")]),s._v(" Sentinel哨兵模式搭建")]),s._v(" "),n("blockquote",[n("p",[s._v("哨兵模式是Redis的高可用解决方案，是由一个哨兵或多个哨兵组成，监听主节点，主节点故障后进行选举，选择新的主节点")])]),s._v(" "),n("p",[s._v("conf配置文件:")]),s._v(" "),n("p",[s._v("redis-sentinel-16380.conf")]),s._v(" "),n("p",[s._v("redis-sentinel_16381.conf")]),s._v(" "),n("p",[s._v("redis-sentinel_16382.conf")]),s._v(" "),n("div",{staticClass:"language-sh line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sh"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Example sentinel.conf   启动哨兵 redis-sentinel /opt/homebrew/etc/redis/redis-sentinel/redis-sentinel.conf")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#保护模式")]),s._v("\nprotected-mode no\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 哨兵端口")]),s._v("\nport "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("16381")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否以守护进程模式后台运行")]),s._v("\ndaemonize "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("yes")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 因为这里在同一台机器上运行多个实例,所以需要指定")]),s._v("\npidfile "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/var/run/redis-sentinel_16381.pid"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日志文件名")]),s._v("\nlogfile "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"redis-sentinel_16381.log"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 日志文件路径")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/opt/homebrew/etc/redis/log"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sentinel monitor <master-name> <ip> <redis-port> <quorum>")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 哨兵监听的主服务器 主机挂掉以后进行投票，只需要2票就可以从机变主机")]),s._v("\nsentinel monitor mymaster "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("6381")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("##当在Redis实例中开启了requirepass，这里就需要提供密码。")]),s._v("\nsentinel auth-pass mymaster xcw1017"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置未得到主机响应时间，此处代表5秒未响应视为宕机")]),s._v("\nsentinel down-after-milliseconds mymaster "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5000")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 故障转移的超时时间failover-timeout，设置一分钟，可以用在以下这些方面：")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 1. 同一个sentinel对同一个master两次failover之间的间隔时间。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 2. 当一个slave从一个错误的master那里同步数据时开始，直到slave被纠正为从正确的master那里同步数据时结束。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 3. 当想要取消一个正在进行的failover时所需要的时间。")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## 4.当进行failover时，配置所有slaves指向新的master所需的最大时间。不过，即使过了这个超时，slaves依然会被正确配置为指向master，但是就不按parallel-syncs所配置的规则来同步数据了")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sentinel failover-timeout <master-name> <milliseconds>")]),s._v("\nsentinel failover-timeout mymaster "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置当某一事件发生时所需要执行的脚本")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sentinel notification-script <master-name> <script-path>")]),s._v("\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br")])]),n("h3",{attrs:{id:"依次启动哨兵"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#依次启动哨兵"}},[s._v("#")]),s._v(" 依次启动哨兵")]),s._v(" "),n("p",[s._v("redis-sentinel /opt/homebrew/etc/redis/redis-sentinel/redis-sentinel_16380.conf")]),s._v(" "),n("p",[s._v("redis-sentinel /opt/homebrew/etc/redis/redis-sentinel/redis-sentinel_16381.conf")]),s._v(" "),n("p",[s._v("redis-sentinel /opt/homebrew/etc/redis/redis-sentinel/redis-sentinel_16382.conf")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://raw.githubusercontent.com/prank-xcw/images/master/imgs/202412031206340.png",alt:"image-20241203120629621"}})]),s._v(" "),n("h3",{attrs:{id:"查看哨兵信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看哨兵信息"}},[s._v("#")]),s._v(" 查看哨兵信息")]),s._v(" "),n("p",[s._v("执行"),n("code",[s._v("info sentinel")]),s._v(" 查看哨兵信息，主节点为 "),n("code",[s._v("127.0.0.1:6381")]),s._v("  从节点2个，哨兵三个")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://raw.githubusercontent.com/prank-xcw/images/master/imgs/202412031207259.png",alt:"image-20241203120748857"}})])])}),[],!1,null,null,null);n.default=t.exports}}]);